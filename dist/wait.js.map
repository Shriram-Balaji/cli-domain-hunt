{"version":3,"file":"wait.js","sources":["../src/wait.js"],"sourcesContent":["const ora = require(\"ora\");\nconst { gray } = require(\"chalk\");\nconst { eraseLines } = require(\"ansi-escapes\");\nconst wait = (msg, timeOut = 300) => {\n\tlet running = false;\n\tlet spinner = null;\n\tlet stopped = false;\n\tsetTimeout(() => {\n\t\tif (stopped) return;\n\t\tspinner = ora(gray(msg));\n\t\tspinner.color = \"gray\";\n\t\tspinner.start();\n\t\trunning = true;\n\t}, timeOut);\n\tconst setText = msg => {\n\t\tspinner.text = msg;\n\t};\n\n\tconst cancel = () => {\n\t\tstopped = true;\n\t\tif (running) {\n\t\t\tspinner.stop();\n\t\t\t// why is this needed\n\t\t\tprocess.stderr.write(eraseLines(1));\n\t\t\trunning = false;\n\t\t}\n\t\tprocess.removeListener(\"dhExit\", cancel);\n\t};\n\tprocess.on(\"dhExit\", cancel);\n\treturn cancel;\n};\n\nmodule.exports = wait;\n"],"names":["const","ora","require","module","exports","msg","timeOut","let","running","spinner","stopped","setTimeout","gray","color","start","cancel","stop","process","stderr","write","eraseLines","removeListener","on"],"mappings":"AAAAA,IAAMC,EAAMC,QAAQ,SACHA,QAAQ,gBACFA,QAAQ,2BA8B/BC,OAAOC,iBA7BOC,EAAKC,kBAAU,KAC5BC,IAAIC,GAAU,EACVC,EAAU,KACVC,GAAU,EACdC,sBACKD,KACJD,EAAUR,EAAIW,EAAKP,KACXQ,MAAQ,OAChBJ,EAAQK,QACRN,GAAU,IACRF,GAKHN,IAAMe,aACLL,GAAU,EACNF,IACHC,EAAQO,OAERC,QAAQC,OAAOC,MAAMC,EAAW,IAChCZ,GAAU,GAEXS,QAAQI,eAAe,SAAUN,IAGlC,OADAE,QAAQK,GAAG,SAAUP,GACdA"}